<HTML>
<HEAD>
<SCRIPT LANGUAGE="JavaScript">

function Calculate() {

cif= document.ki.gg2.value;

  num =	document.ki.nr.value ;

 if(num < "3") {document.ki.d1.value ="0"; document.ki.d2.value ="0";document.ki.d3.value =" ";}
 if(num < "4") {document.ki.e1.value ="0"; document.ki.e2.value ="0";document.ki.e3.value =" ";}
 if(num < "5") {document.ki.f1.value ="0"; document.ki.f2.value ="0";document.ki.f3.value =" ";}
 if(num < "6") {document.ki.g1.value ="0"; document.ki.g2.value ="0";document.ki.g3.value =" ";}

   O1=	document.ki.b1.value ;
   O2=	document.ki.c1.value ;
   O3=	document.ki.d1.value ;
   O4=	document.ki.e1.value ;
   O5=	document.ki.f1.value ;
   O6=	document.ki.g1.value ;

   n1=	document.ki.b2.value ;
   n2=	document.ki.c2.value ;
   n3=	document.ki.d2.value ;
   n4=	document.ki.e2.value ;
   n5=	document.ki.f2.value ;
   n6=	document.ki.g2.value ;

n =eval(O1) + eval(O2) + eval(O3) + eval(O4) + eval(O5) + eval(O6) ;
fr =eval(n1) + eval(n2) + eval(n3) + eval(n4) + eval(n5) + eval(n6) ;
if(fr != 1 ) {alert("Error in freq.\n Do not sum to - set the class number correct !");exit();}

document.ki.h1.value = "N  = " + n ;

   ee1=(n1*n);
document.ki.b3.value =  ee1.toFixed(cif);

   ee2=(n2*n);
document.ki.c3.value = ee2.toFixed(cif);

    ee3=(n3*n);
document.ki.d3.value = ee3.toFixed(cif);

   ee4=(n4*n);
document.ki.e3.value =  ee4.toFixed(cif);

   ee5=(n5*n);
document.ki.f3.value = ee5.toFixed(cif);

   ee6=(n6*n); 
document.ki.g3.value = ee6.toFixed(cif);

ki= (O1-ee1)*(O1-ee1)/ee1 + (O2-ee2)*(O2-ee2)/ee2 ;

if(ee3 > 0){ki += (O3-ee3)*(O3-ee3)/ee3 ;}
if(ee4 > 0){ki += (O4-ee4)*(O4-ee4)/ee4 ;}
if(ee5 > 0){ki += (O5-ee5)*(O5-ee5)/ee5 ;}
if(ee6 > 0){ki += (O6-ee6)*(O6-ee6)/ee6 ;}

 document.ki.h2.value = " Chi = " + ki.toFixed(cif);
}
  
function Nullify() {
 document.ki.b1.value ="0"; document.ki.b2.value ="0";document.ki.b3.value =" ";
 document.ki.c1.value ="0"; document.ki.c2.value ="0";document.ki.c3.value =" ";
 document.ki.d1.value ="0"; document.ki.d2.value ="0";document.ki.d3.value =" ";
 document.ki.e1.value ="0"; document.ki.e2.value ="0";document.ki.e3.value =" ";
 document.ki.f1.value ="0"; document.ki.f2.value ="0";document.ki.f3.value =" ";
 document.ki.g1.value ="0"; document.ki.g2.value ="0";document.ki.g3.value =" ";

  document.ki.h1.value = "N";
  document.ki.h2.value = "chi";
  document.ki.nr.value = "2";
}

</SCRIPT>
 <title>Calculation of Chi-square test for deviation from Mendelian ratios </title> 
</HEAD>
<BODY BGCOLOR="#00FFFF">

<H3>
5.6 Calculation of Chi-square test for deviation from Mendelian ratios</H3>
- Put your observed numbers and expected ratios (shall sum up to one) and
click  the <B>calculation</B> button. Leave the zeros in the untuched fields. 

<p><FORM name="ki">
 
<table border="4"><tr>
<td>Number of classes put -></td>
<td><input type="text" name="nr" value="2" ></td>
<td>Set digit for print -> </td>
<td><input type="text" name="gg2" value="4" ></td>

</tr><tr>
  <td><input type="text" name="a1" value="Observed numbers" ></td>
  <td><input type="text" name="a2" value="Expected frequency" ></td>

</tr><tr>
  <td><input type="text" name="b1" value="25" ></td>
  <td><input type="text" name="b2"  value="0.5" ></td>
  <td><input type="text" name="b3" value="" ></td>
  <td><input type="button" name="a3" value="Calculate" OnClick="Calculate()"></td>
  
</tr><tr>
  <td><input type="text" name="c1" value="15" ></td>
  <td><input type="text" name="c2" value="0.5" ></td>
 <td><input type="text" name="c3" value="" ></td>

</tr><tr> 
  <td><input type="text" name="d1" value="0" ></td>
  <td><input type="text" name="d2" value="0" ></td>
  <td><input type="text" name="d3" value="" ></td>
 </tr><tr>
  <td><input type="text" name="e1" value="0" ></td>
  <td><input type="text" name="e2" value="0" ></td>
  <td><input type="text" name="e3" value="" ></td>

</tr><tr>
  <td><input type="text" name="f1" value="0" ></td>
 <td><input type="text" name="f2" value="0" ></td>
  <td><input type="text" name="f3" value="" ></td>

</tr><tr> 
  <td><input type="text" name="g1" value="0" ></td>
  <td><input type="text" name="g2" value="0" ></td>
  <td><input type="text" name="g3" value="" ></td>
  <td><input type="button" name="h3" value="Nullify" OnClick="Nullify()"></td>

</tr><tr>
  <td><input type="text" name="h1" value="N" ></td>
  <td><input type="text" name="h2" value="Chi-" ></td>

</tr><tr>
  <td><input type="text" name="i1" value="Knud Christensen" ></td>
  <td><input type="text" name="i2" value="Mail kc@sund.ku.dk" ></td>
  <td><input type="text" name="i3" value="April 2015" ></td>

</tr></table></form>

<p>The number of degrees of freedom for the Chi-square is equal to the
number of cells with expected values minus one.Two classes can correspond to dominant inheritance or a back cross
<hr>
Example:
<br>Test of segregation ratios from known mating can be done by Chi-square
test. If you have a test mating between two heterozygotes Aa x Aa the offspring - which give 3 classes of offspring (put 3)
would have an expected  segregation ratio of 1:2:1 as shown in the table below, where
the ratios are converted to a 0.25 : 0.5 : 0.25.
<PRE>Genotype      AA               Aa             aa       Total
-----------------------------------------------------------------
Number, obs   <B> 30               51             39 </B>     = 120 = N
Frequency,    <B> .25              .5            .25  </B>    = 1,00
Number,         30               60             30      = 120
Deviations      0                -9              9 
Chi-Square      0               1,35            2,70    = 4,05
----------</PRE>
To test the program put the bold face values from the table in the program
and  press the <B>Calculate</B> button.

<P>The number of degrees of freedom is df = 3-1 = 2, as the material is
only providing the parameter N being used to calculate the expected numbers.
The Chi-square value is less than the test value 5,99, which means that
there is not statistically significant deviations from a 1:2:1 segregation
ratio on the 5% level.

<hr>
Questions:
<br>Calculate  a Chi-square for the following observation set from test 
mating of known carriers.
<PRE>Total numbers of observations   30
Number of affected              16</pre>
<p>Is the segregation ratio statistically significant different from a 1:3 segregation 
ratio ?
<hr>


 <A HREF="../../genetics/5/6.htm">Back to theory</A>,
 <A HREF="../5/6.htm">Back to theory (in Danish)</A>

or <A HREF="0.htm">Back to the other programs</A>
</BODY>
</HTML>
